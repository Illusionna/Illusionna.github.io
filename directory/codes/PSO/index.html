<!DOCTYPE html>
<html>
    <head>
        <title>PSO</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="/assets/css/WuWangSheng.css" type="text/css">
        <link rel="stylesheet" href="/assets/css/WuWangShengLPQ2GZE.css">
        <link rel="stylesheet" href="/assets/css/WuWangShengStyle.css" type="text/css">

        <link href="/assets/css/customBMPI.css" rel="stylesheet">
        <link href="/assets/css/prism.css" rel="stylesheet" />
    	<script src="/assets/js/prism.js"></script>

        <script>
            MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']]
                }
            };
        </script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    </head>

    <body>
        <div id="loader" class="loader">
            <div class="text" style="font-size: 48px; font-family:courier;">Loading...</div>
            <div class="horizontal">
              <div class="circlesup">
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
              </div>
              <div class="circlesdwn">
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
              </div>
            </div>
            <div class="vertical">
              <div class="circlesup">
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
              </div>
              <div class="circlesdwn">
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
                    <div class="circle"></div>
              </div>
            </div>
        </div>

        <div style="height: 25px; top: 0; position: sticky; background-color: rgba(250,250,250,1); z-index: 9998;"></div>

        <header class="header">
            <div class="header-container">
                <a style="text-decoration: none" href="/" target="_blank">
                    <div class="logo-words-couple">
                        <div class="page-title-words-container">
                            <div class="page-title-words"><span class="highlight-words">Orzzz.net</span></div>
                        </div>
                    </div>
                </a>
            </div>
        </header>

        <main class="main" id="normal-page" style="display: none;">
            <div class="project-page-layout-justify">
                <div class="project-justified-box pbox1">
                    <div class="pbox1-content-container">
                        <div class="sub-nav" style="display: flex; flex-direction: row; align-items: center;">
                            <span>Table of Contents</span>
                        </div>
                        <div class="page-content-box">
                            <ul class="page-content-list">
                                <li style="margin-bottom: 1em;"><a class="content-link" href="#Introduction">1. Introduction</a></li>
                                <li style="margin-bottom: 1em;"><a class="content-link" href="#Theorem">2. Theorem</a></li>
                                <li style="margin-bottom: 1em;"><a class="content-link" href="#Description">3. Description</a></li>
                                <li style="margin-bottom: 1em;"><a class="content-link" href="#Example">4. Example</a></li>
                                <li style="margin-bottom: 0.25em;"><a class="content-link" href="#Conclusion">5. Conclusion</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="project-justified-box pbox2">
                    <div class="page-content">
                        <div class="story-title">Particle Swarm Optimization</div>
                        <div class="story-time">Friday, November 14, 2025, at 23:37.</div>
                        <div class="story-content-section">
                            <div class="story-content-paragraph">
                                <div class="download-file-box-container">
                                    <a style="text-decoration: none !important; color: inherit; height: 100%; display: flex; align-items: center;" class="download-file-link" href="./resources/main.c" download="main.c">
                                        <div class="download-file-left">
                                            <div class="download-file-box-icon">
                                                <img class="file-type-icon-csv" src="./C.png">
                                            </div>
                                            <div class="download-file-left-words">
                                                <div class="download-file-name">main.c</div>
                                                <div style="color: rgb(225, 45, 120);" class="download-file-name-describe">Click here to download the PSO C code.</div>
                                            </div>
                                        </div>
                                        <div class="download-file-right">
                                            <img class="action-icon" src="./download.png">
                                        </div>
                                    </a>
                                </div>
                            </div>

                            <div class="story-content-paragraph">
                                <div class="download-file-box-container">
                                    <a style="text-decoration: none !important; color: inherit; height: 100%; display: flex; align-items: center;" class="download-file-link" href="./resources/PSO.pdf" target="_blank">
                                        <div class="download-file-left">
                                            <div class="download-file-box-icon">
                                                <img class="file-type-icon-csv" src="./PDF.png">
                                            </div>
                                            <div class="download-file-left-words">
                                                <div class="download-file-name">PSO.pdf</div>
                                                <div style="color: rgb(225, 45, 120);" class="download-file-name-describe">Redirect to the PSO PDF document.</div>
                                            </div>
                                        </div>
                                        <div class="download-file-right">
                                            <img class="action-icon" src="./redirect.png">
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="story-content-section" id="Introduction">
                            <div class="story-content-section-name">1. Introduction</div>
                            <div class="story-content-paragraph">
                                Particle Swarm Optimization algorithm simulates birds to establish an optimized model. It is used to solve optimization problem mainly. PSO is created by Eberhart and Kennedy in 1995. It is studied from birds foraging.
                            </div>

                            <div class="story-content-paragraph">
                                Suppose a group of birds are foraging. Within the zone, there is only one place where there is food. All the birds cannot see the food. But the birds can smell the food (they know the food is far or near them). Suppose all the birds can share information with each other (they know each other how far each bird is from the food). Therefore, the best strategy is to comprehensively consider the two factors of the closest position of oneself to the food and the closest positions of other birds to the food in order to finding the optimal position solution.
                            </div>
                        </div>

                        <div class="story-content-section" id="Theorem">
                            <div class="story-content-section-name">2. Theorem</div>
                            <div class="story-content-paragraph">
                                The formula of the Particle Swarm Optimization algorithm is as follows:
                                <div style="text-align: center;">
                                    <a style="color: rgb(225, 45, 120);">
                                        $v_n(t+1)=\omega(t)\cdot v_n(t)+c_1r_1\cdot[p_n-x_n(t)]+c_2r_2\cdot[g-x_n(t)]$
                                    </a>
                                </div>
                                The iterative expression is as follows:
                                <div style="text-align: center;">
                                    <a style="color: rgb(225, 45, 120);">
                                        $x_n(t+1)=x_n(t)+v_n(t+1)$
                                    </a>
                                </div>
                                The inertia factor $\omega(t)$ can be a linearly decreasing weight function or a constant:
                                <div style="text-align: center;">
                                    $\omega(t)=\begin{cases}
                                        \omega_{\rm max}-\dfrac{\omega_{\rm max}-\omega_{\rm min}}{t_{\rm max}}\times t\qquad \omega_{\rm max}\approx0.9,\ \omega_{\rm min}\approx0.4
                                        \\[8pt]
                                        C\in[0.6,\ 0.75]
                                    \end{cases}$
                                </div>
                                If $\omega(t)$ value is larger, the search range of the solution will be larger, which can improve the global search ability of the algorithm, but it also loses the local search ability and may miss the optimal solution. Conversely, if $\omega(t)$ value is smaller, the search range of the solution will be smaller, the global search ability of the algorithm will be smaller, and it is easy to fall into local optimum.
                            </div>
                        </div>

                        <div class="story-content-section" id="Description">
                            <div class="story-content-section-name">3. Description</div>
                            <div class="story-content-paragraph">
                                The parameters is elaborated as:
                                <ul class="list-in-paragraph">
                                    <li>$n$: the amount of particles (<strong>usually</strong> $20\sim40$).</li>
                                    <li>$v_n(t)$: the velocity of the $t$ epoch of the $n$-th particle.</li>
                                    <li>$x_n(t)$: the distance of the $t$ epoch of the $n$-th particle.</li>
                                    <li>$c_1$: the individual learning factor of the particle.</li>
                                    <li>$c_2$: the swarm learning factor of the particle.</li>
                                    <li>$r_1$: the random float number is between 0 and 1.</li>
                                    <li>$r_2$: the random float number is between 0 and 1.</li>
                                    <li>$p_n$: the best solution of the $n$-th particle.</li>
                                    <li>$g$: the global optimal solution of particle swarm.</li>
                                </ul>
                                Some empirical values are provided by scholars:
                                <ul class="list-in-paragraph">
                                    <li><a class="inline-link">Clerc ($c_1=c_2=2.05$)</a></li>
                                    <li>Carlisle ($c_1=2.8,\ c_2=1.3$)</li>
                                    <li>Trelea ($\omega=0.6,\ c_1=c_2=1.7$)</li>
                                    <li><a class="inline-link">Eberhart ($\omega=0.729,\ c_1=c_2=1.494$)</a></li>
                                </ul>
                            </div>
                        </div>

                        <div class="story-content-section" id="Example">
                            <div class="story-content-section-name">4. Example</div>
                            <div class="story-content-paragraph">
                                The univariate function is as follows:
                                <div style="text-align: center;">
                                    $ f(x)=x^4-2x^3+3x^2-4x+5\qquad x\in[-5,\ 5] $
                                </div>
                                The binary function is as follows:
                                <div style="text-align: center;">
                                    $f(x,y)=x^2 - 2 x y + 2  y^2 - 2 x - 4 y + 27\qquad x,y\in[-5,\ 5]$
                                </div>
                                The $n$ dimension Rastrigin function is as follows:
                                <div style="text-align: center;">
                                    $ f(x_1,x_2,\ldots,x_n)=Cn+\displaystyle\sum_{i=1}^{n}(x_i^2-C\cos2\pi x_i)\qquad C=10 $
                                </div>
                                It is studied that the dimension is $n=2$.
                                <div style="text-align: center;">
                                    $ f(x,y)=20+x^2-10\cos2\pi x+y^2-10\cos2\pi y\qquad x,y\in[-5,\ 5] $
                                </div>
                                The C code is as follows:
<pre>
<code class="language-c" style="font-size: 12px">
#include &lt;time.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

static unsigned long long seed = 1;

double f1d(double x) {
    return x * x * x * x - 2 * x * x * x + 3 * x * x - 4 * x + 5;
}

double f2d(double x, double y) {
    return x * x - 2 * x * y + 2 * y * y - 2 * x - 4 * y + 27;
}

#ifdef __APPLE__
static double multiple(double a, double b) {
    double result;
    __asm__ volatile (
        "fmul %d0, %d1, %d2"
        : "=w" (result)
        : "w" (a), "w" (b)
        :
    );
    return result;
}
#endif

void dsrand(unsigned int i) {
    seed = (((long long int)i) << 16) | rand();
}

double drandom(double low, double high) {
    seed = (0x5DEECE66DLL * seed + 0xB16) & 0xFFFFFFFFFFFFLL;
    return low + (high - low) * ((double)(seed >> 16) / (double)0x100000000LL);
}

void progress_bar(int current, int epoch) {
    int width = 50;
    printf("\x1b[?25l");
    float percentage = (current + 1.0) / epoch;
    int filled = percentage * width;
    printf("\r[");
    for (int j = 0; j < width; j++) {
        if (j < filled) printf("\x1b[32m=\x1b[0m");
        else if (j == filled) printf(">");
        else printf(" ");
    }
    printf("] %7.2f%% (%d/%d)", percentage * 100, current + 1, epoch);
    fflush(stdout);

    if (current == epoch - 1) printf("\x1b[?25h\n");
}

double min(double *array, int length) {
    if (length == 1) return array[0];
    double result = array[0];
    for (int i = 1; i < length; i++) {
        if (result > array[i]) {
            result = array[i];
        }
    }
    return result;
}

int argmin(double *array, int length) {
    if (length == 1) return 0;
    int idx = 0;
    double result = array[0];
    for (int i = 1; i < length; i++) {
        if (result > array[i]) {
            result = array[i];
            idx = i;
        }
    }
    return idx;
}

double clip(double x, double low, double high) {
    if (x < low) return low;
    if (x > high) return high;
    return x;
}

double linear_decreasing_weight(int t, int t_max) {
    return 0.9 - 0.5 * t / t_max;
}

void particle_swarm_optimization_1d(
    int epoch,
    int n_particles,
    double w,
    double c1,
    double c2,
    double x_min,
    double x_max
) {
    double v_max = (x_max - x_min) / 5.0;

    double *x = (double *)malloc(sizeof(double) * n_particles);
    double *v = (double *)malloc(sizeof(double) * n_particles);
    double *p = (double *)malloc(sizeof(double) * n_particles);
    double *y = (double *)malloc(sizeof(double) * n_particles);

    for (int n = 0; n < n_particles; n++) {
        x[n] = drandom(x_min, x_max);
        v[n] = drandom(-v_max, v_max);
        p[n] = x[n];
        y[n] = f1d(x[n]);
    }

    double g = min(p, n_particles);
    double g_value = min(y, n_particles);

    for (int t = 0; t < epoch; t++) {
        // All particles are shared with the same random parameters.
        double r1 = drandom(0.0, 1.0);
        double r2 = drandom(0.0, 1.0);

        for (int n = 0; n < n_particles; n++) {
            v[n] = w * v[n] + c1 * r1 * (p[n] - x[n]) + c2 * r2 * (g - x[n]);
            v[n] = clip(v[n], -v_max, v_max);
            x[n] = x[n] + v[n];
            x[n] = clip(x[n], x_min, x_max);

            if (f1d(x[n]) < y[n]) {
                y[n] = f1d(x[n]);
                p[n] = x[n];
            }
        }

        int idx = argmin(y, n_particles);
        g_value = y[idx];
        g = p[idx];

        progress_bar(t, epoch);
    }

    printf("global optimal solution: %lf\n", g);
    printf("global optimal value:    %lf\n", g_value);

    free(x);
    free(v);
    free(p);
    free(y);
}

void particle_swarm_optimization_2d(
    int epoch,
    int n_particles,
    double c1,
    double c2,
    double x_min,
    double x_max,
    double y_min,
    double y_max
) {
    double v_x_max = (x_max - x_min) / 5.0;
    double v_y_max = (y_max - y_min) / 5.0;

    double (*x)[2] = (double (*)[2])malloc(sizeof(double) * n_particles * 2);
    double (*v)[2] = (double (*)[2])malloc(sizeof(double) * n_particles * 2);
    double (*p)[2] = (double (*)[2])malloc(sizeof(double) * n_particles * 2);
    double *y = (double *)malloc(sizeof(double) * n_particles);

    for (int n = 0; n < n_particles; n++) {
        x[n][0] = drandom(x_min, x_max);
        x[n][1] = drandom(y_min, y_max);
        v[n][0] = drandom(-v_x_max, v_x_max);
        v[n][1] = drandom(-v_y_max, v_y_max);
        p[n][0] = x[n][0];
        p[n][1] = x[n][1];
        y[n] = f2d(x[n][0], x[n][1]);
    }

    double g[2] = {min(p[0], n_particles), min(p[1], n_particles)};
    double g_value = min(y, n_particles);

    for (int t = 0; t < epoch; t++) {
        for (int n = 0; n < n_particles; n++) {
            // Each particle uses different random parameters.
            double r1 = drandom(0.0, 1.0);
            double r2 = drandom(0.0, 1.0);

            double w = linear_decreasing_weight(t, epoch);

            v[n][0] = multiple(w, v[n][0])
                    +
                    multiple(multiple(c1, r1), p[n][0] - x[n][0])
                    +
                    multiple(multiple(c2, r2), g[0] - x[n][0]);
            v[n][1] = multiple(w, v[n][1])
                    +
                    multiple(multiple(c1, r1), p[n][1] - x[n][1])
                    +
                    multiple(multiple(c2, r2), g[1] - x[n][1]);

            v[n][0] = clip(v[n][0], -v_x_max, v_x_max);
            v[n][1] = clip(v[n][1], -v_y_max, v_y_max);

            x[n][0] = x[n][0] + v[n][0];
            x[n][1] = x[n][1] + v[n][1];

            x[n][0] = clip(x[n][0], x_min, x_max);
            x[n][1] = clip(x[n][1], y_min, y_max);

            if (f2d(x[n][0], x[n][1]) < y[n]) {
                y[n] = f2d(x[n][0], x[n][1]);
                p[n][0] = x[n][0];
                p[n][1] = x[n][1];
            }
        }

        int idx = argmin(y, n_particles);
        g_value = y[idx];
        g[0] = p[idx][0];
        g[1] = p[idx][1];

        progress_bar(t, epoch);
    }

    printf("global optimal solution: (%lf, %lf)\n", g[0], g[1]);
    printf("global optimal value:    %lf\n", g_value);

    free(x);
    free(v);
    free(p);
    free(y);
}

int main(int argc, char *argv[], char *envs[]) {
    dsrand((unsigned int)time(NULL));

    int n_particles = 30;
    double w = 0.7;
    double c1 = 2.8;
    double c2 = 1.3;
    double x_min = -5.0;
    double x_max = 5.0;
    double y_min = -5.0;
    double y_max = 5.0;
    int epoch = 10000;

    particle_swarm_optimization_1d(epoch, n_particles, w, c1, c2, x_min, x_max);
    particle_swarm_optimization_2d(
        epoch, n_particles,
        c1, c2,
        x_min, x_max,
        y_min, y_max
    );

    return 0;
}
</code></pre>

                                <img id="result" class="in-text-pics">
                            </div>
                        </div>

                        <div class="story-content-section" id="Conclusion">
                            <div class="story-content-section-name">5. Conclusion</div>
                            <div class="story-content-paragraph">
                                Particle Swarm Optimization algorithm has few parameters and simple steps, helping the optimal solution convergent quickly. But it is an intractable problem that PSO gets trapped in a local best solution. Therefore, the PSO algorithm depends on a good initialization.
                            </div>
                            <div class="story-content-paragraph">
                                That's all for the description of the project. If you have any questions about this, plzzzzz contact <a class="inline-link" href="/" target="_blank">Illusionna</a> by email. Thanks for your reading.
                            </div>
                        </div>

                    </div>

                    <div class="page-end"></div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <div class="foot-container">
                <div class="copy-right">MIT License</div>
            </div>
        </footer>
    </body>

    <script>
        let imagesToLoad = [
            { id: 'result', src: './resources/result.png' }
        ];

        function loadImage(imgId, src, callback) {
            let img = new Image();
            img.src = src;
            img.onload = function() {
                document.getElementById(imgId).src = src;
                callback();
            };
        }

        function loadImages(imgIdsAndSrcs, callback) {
            let loadedCount = 0;
            let totalCount = imgIdsAndSrcs.length;
            imgIdsAndSrcs.forEach(function(imgInfo) {
                loadImage(imgInfo.id, imgInfo.src, function() {
                    loadedCount++;
                    if (loadedCount === totalCount) {
                        callback();
                    }
                });
            });
        }

        let loader = document.getElementById('loader');
        let normalPage = document.getElementById('normal-page');

        loadImages(imagesToLoad, function() {
            loader.style.display = 'none';
            normalPage.style.display = 'block';
        });
    </script>
</html>
